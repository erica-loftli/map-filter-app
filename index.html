<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Interactive Price & Room Filter</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      margin: 0;
    }

    .filter-box {
      max-width: 600px;
      margin-bottom: 20px;
    }

    .filter-box label {
      font-weight: bold;
      display: block;
      margin-bottom: 5px;
    }

    .range-values {
      display: flex;
      justify-content: space-between;
      margin-bottom: 10px;
    }

    .map-container {
      width: 100%;
      height: 500px;
    }

    .dropdown {
      width: 100%;
      padding: 8px;
      margin-top: 10px;
    }

    .apply-btn {
      margin-top: 10px;
      padding: 10px 20px;
      background-color: #e63946;
      color: white;
      border: none;
      cursor: pointer;
      font-weight: bold;
    }

    .apply-btn:hover {
      background-color: #d62839;
    }
  </style>
</head>
<body>

<div class="filter-box">
  <label for="priceRange">Prix par mois ($ CAD)</label>
  <input type="range" id="priceRange" min="0" max="4650" value="3000" step="50">
  <div class="range-values">
    <span>0</span>
    <span id="priceValue">3000</span>
    <span>4650</span>
  </div>

  <label for="roomType">Type de logement</label>
  <select id="roomType" class="dropdown">
    <option value="any">Tous types</option>
    <option value="Studio">Studio</option>
    <option value="1BR">1 chambre</option>
    <option value="2BR">2 chambres</option>
  </select>

  <button class="apply-btn" onclick="applyFilters()">APPLIQUER →</button>
</div>

<div class="map-container" id="map"></div>

<!-- Google Maps JS API -->
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBtBNTPQ_kMfBJEPurwzxJUvWXZOIQXlec"></script>

<script>
  const listings = [
    { title: "Studio à Québec", price: 950, type: "Studio", lat: 46.8139, lng: -71.2082 },
    { title: "1BR à Sainte-Foy", price: 1400, type: "1BR", lat: 46.7800, lng: -71.3000 },
    { title: "2BR à Limoilou", price: 1800, type: "2BR", lat: 46.8500, lng: -71.2300 },
    { title: "1BR à Lévis", price: 1200, type: "1BR", lat: 46.7400, lng: -71.1900 },
    { title: "2BR de luxe", price: 4200, type: "2BR", lat: 46.8100, lng: -71.2500 }
  ];

  let map;
  let markers = [];

  function initMap() {
    map = new google.maps.Map(document.getElementById("map"), {
      center: { lat: 46.8139, lng: -71.2082 },
      zoom: 11
    });

    applyFilters(); // initial load
  }

  function clearMarkers() {
    for (const m of markers) m.setMap(null);
    markers = [];
  }

  function applyFilters() {
    const maxPrice = document.getElementById("priceRange").value;
    const roomType = document.getElementById("roomType").value;

    document.getElementById("priceValue").textContent = maxPrice;

    const filtered = listings.filter(l =>
      l.price <= maxPrice && (roomType === "any" || l.type === roomType)
    );

    clearMarkers();

    for (const listing of filtered) {
      const marker = new google.maps.Marker({
        position: { lat: listing.lat, lng: listing.lng },
        map,
        title: `${listing.title} - $${listing.price}`
      });

      markers.push(marker);
    }
  }

  document.getElementById("priceRange").addEventListener("input", e => {
    document.getElementById("priceValue").textContent = e.target.value;
  });

  window.onload = initMap;
</script>

</body>
</html>
